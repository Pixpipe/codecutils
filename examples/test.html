<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Test</title>
</head>
<body>
  <!-- importing the automatically build module -->
  <script src="../dist/codecutils.js"></script>

  <p>Open Javascript console.</p>

  <script>
  
    //************ TEST 1 ***********************************************
    console.log("TEST 1");
    const CodecUtils = codecutils.CodecUtils;

    console.log("Is plaftform little endian: " + CodecUtils.isPlatformLittleEndian() );

    var stringBefore = "I can has üçî";
    var strBuff = CodecUtils.string16ToArrayBuffer( stringBefore );
    var stringAfter = CodecUtils.arrayBufferToString16( strBuff )

    if( stringBefore ===  stringAfter){
      console.log("unicode string to arraybuffer and back works");
    }else{
      console.log("booh");
    }

    //*************** TEST 2 *******************************************
    console.log("TEST 2 ");
    
    var jack = {
      _data: [new Float32Array([512, 514, 516, 52000, 52010, 52011]), new Float32Array([12, 14, 16, 2000, 2010, 2011, 23])],
      _metadata: {
        firstname: "Jack",
        lastname: "Foo",
        date: new Date(),
        description: "this is the description of the Jack Foo block."
      }
    }
    
    var anArray = new Float32Array([12, 14, 16, 2000, 2010, 2011, 23])
    
    var jack2 = {
      _data: {
        array1: new Float32Array([512, 514, 516, 52000, 52010, 52011]),
        array2: anArray
      },
      _metadata: {
        firstname: "Jack",
        lastname: "Foo",
        date: new Date(),
        description: "this is the description of the Jack Foo block."
      }
    }
    
    var nbTypedArr = CodecUtils.howManyTypedArrayAttributes( jack );
    console.log( nbTypedArr );
    
    var hasCircRef = CodecUtils.hasCircularReference( jack2 )
    console.log( "has circular ref: " + hasCircRef );

    jack2._metadata.circ = jack2._metadata;
    hasCircRef = CodecUtils.hasCircularReference( jack2 )
    console.log( "has circular ref: " + hasCircRef );
    
    var circRefFreeJack2 = CodecUtils.removeCircularReference( jack2 )
    console.log(circRefFreeJack2);
    
    var noTypedArrayJack2 = CodecUtils.replaceTypedArrayAttributesByArrays2( jack2 );
    console.log( noTypedArrayJack2 );
    
  </script>

</body>
</html>
